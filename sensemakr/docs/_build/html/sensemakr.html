
<!DOCTYPE html>

<html lang="Python">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>sensemakr.sensemakr &#8212; Pysensemakr  documentation</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/blank.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="sensemakr" href="modules.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="Python">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    
<a class="navbar-brand" href="index.html">
<p class="title">Pysensemakr</p>
</a>

    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="notebooks/quickstart.html">
  Quickstart Example of Pysensemakr Package
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="notebooks/the_risks_of_informal_benchmarking.html">
  The risks of informal benchmarking
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="modules.html">
  sensemakr
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
  <h4>Previous topic</h4>
  <p class="topless"><a href="modules.html"
                        title="previous chapter">sensemakr</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   sensemakr.sensemakr
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sensemakr-ovb-plots">
   sensemakr.ovb_plots
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#description">
     Description
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#reference">
     Reference
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example">
     Example
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-sensemakr.bias_functions">
   sensemakr.bias_functions
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Description
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parameters">
     Parameters
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#list-of-parameters">
       List of parameters
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#parameters-only-used-in-param-check">
       Parameters only used in param_check
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Reference
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     Example
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sensemakr-sensitivity-stats">
   sensemakr.sensitivity_stats
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     Description
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     Reference
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     Example
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sensemakr-ovb-bounds">
   sensemakr.ovb_bounds
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     Description
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id8">
     Reference
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id9">
     Example
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-sensemakr.data">
   sensemakr.data
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id10">
     Description
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id11">
     Reference
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id12">
     Example
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <p><strong>Description</strong></p>
<p>This is a Python version of the original R sensemakr package, which can be found here:
<a class="reference external" href="https://github.com/carloscinelli/sensemakr">https://github.com/carloscinelli/sensemakr</a></p>
<p>R's linear model (&quot;lm&quot;) and data.frame objects most naturally translate into statsmodels OLS/OLSResults and pandas
DataFrame/Series objects, so we have used those in the python version. These packages are not universally familiar
to python users, but they were the most straightforward and faithful way to translate the R package into Python.
Examples are included below to demonstrate how to use these objects to run this package successfully.</p>
<p>There are some features of the original package that have not yet been implemented. For instance, R's notion of
&quot;formulas&quot; for linear models are less used by and less familiar to python programmers, and thus have not yet been
included in the Python version. This could change if there is sufficient demand.</p>
<p>The sensemakr package implements a suite of sensitivity analysis tools that makes it easier to
understand the impact of omitted variables in linear regression models, as discussed in Cinelli and Hazlett (2020).</p>
<p>This package defines a class called Sensemakr, which computes the most common sensitivity analysis results.
After creating an object of the Sensemakr class, you may directly use the plot and print methods of the object.</p>
<p>You may also use the other sensitivity functions of the package directly, such as the functions for sensitivity plots
(ovb_contour_plot, ovb_extreme_plot) the functions for computing bias-adjusted estimates and t-values
(adjusted_estimate, adjusted_t), the functions for computing the robustness value and partial R2 (robustness_value,
partial_r2),  or the functions for bounding the strength of unobserved confounders (ovb_bounds), among others.</p>
<p>More information can be found on the help documentation and related papers.</p>
<p><strong>Reference</strong></p>
<p>Cinelli, C. and Hazlett, C. (2020), &quot;Making Sense of Sensitivity: Extending Omitted Variable Bias.&quot;
Journal of the Royal Statistical Society, Series B (Statistical Methodology).</p>
<p><strong>Example</strong></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load example dataset:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">darfur</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">load_darfur</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Fit a statsmodels OLSResults object (&quot;fitted_model&quot;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s1">&#39;peacefactor ~ </span><span class="se">\</span>
<span class="go">        directlyharmed + age + farmer_dar + herder_dar + pastvoted + hhsize_darfur + female + village&#39;, data=darfur)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fitted_model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Runs sensemakr for sensitivity analysis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">sensemakr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sensitivity</span> <span class="o">=</span> <span class="n">sensemakr</span><span class="o">.</span><span class="n">Sensemakr</span><span class="p">(</span>
<span class="go">        fitted_model, treatment = &quot;directlyharmed&quot;, benchmark_covariates = &quot;female&quot;, kd = [1, 2, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Description of results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sensitivity</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Import plot module</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">ovb_plots</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot bias contour of point estimate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ovb_plots</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sensitivity</span><span class="p">,</span><span class="n">plot_type</span> <span class="o">=</span> <span class="s2">&quot;contour&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot extreme scenario</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ovb_plots</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sensitivity</span><span class="p">,</span> <span class="n">plot_type</span> <span class="o">=</span> <span class="s2">&quot;extreme&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#Pandas DataFrame with sensitivity statistics</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sensitivity</span><span class="o">.</span><span class="n">sensitivity_stats</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Pandas DataFrame with bounds on the strength of confounders</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sensitivity</span><span class="o">.</span><span class="n">bounds</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Using sensitivity functions directly</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">sensitivity_stats</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">ovb_bounds</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">bias_functions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Robustness value of directly harmed q = 1 (reduce estimate to zero)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sensitivity_stats</span><span class="o">.</span><span class="n">robustness_value</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">fitted_model</span><span class="p">,</span> <span class="n">covariates</span> <span class="o">=</span> <span class="s1">&#39;directlyharmed&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Robustness value of directly harmed q = 1/2 (reduce estimate in half)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sensitivity_stats</span><span class="o">.</span><span class="n">robustness_value</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">fitted_model</span><span class="p">,</span> <span class="n">covariates</span> <span class="o">=</span> <span class="s1">&#39;directlyharmed&#39;</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Robustness value of directly harmed q = 1/2, alpha = 0.05</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sensitivity_stats</span><span class="o">.</span><span class="n">robustness_value</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">fitted_model</span><span class="p">,</span> <span class="n">covariates</span> <span class="o">=</span> <span class="s1">&#39;directlyharmed&#39;</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Partial R2 of directly harmed with peacefactor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sensitivity_stats</span><span class="o">.</span><span class="n">partial_r2</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">fitted_model</span><span class="p">,</span> <span class="n">covariates</span> <span class="o">=</span> <span class="s2">&quot;directlyharmed&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Partial R2 of female with peacefactor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sensitivity_stats</span><span class="o">.</span><span class="n">partial_r2</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">fitted_model</span><span class="p">,</span> <span class="n">covariates</span> <span class="o">=</span> <span class="s2">&quot;female&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Pandas DataFrame with sensitivity statistics</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sensitivity_stats</span><span class="o">.</span><span class="n">sensitivity_stats</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">fitted_model</span><span class="p">,</span> <span class="n">treatment</span> <span class="o">=</span> <span class="s2">&quot;directlyharmed&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Bounds on the strength of confounders using female and age</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ovb_bounds</span><span class="o">.</span><span class="n">ovb_bounds</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">fitted_model</span><span class="p">,</span> <span class="n">treatment</span> <span class="o">=</span> <span class="s2">&quot;directlyharmed&quot;</span><span class="p">,</span>
<span class="go">    benchmark_covariates = [&quot;female&quot;, &quot;age&quot;], kd = [1, 2, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Adjusted estimate given hypothetical strength of confounder</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bias_functions</span><span class="o">.</span><span class="n">adjusted_estimate</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">fitted_model</span><span class="p">,</span> <span class="n">treatment</span> <span class="o">=</span> <span class="s2">&quot;directlyharmed&quot;</span><span class="p">,</span> <span class="n">r2dz_x</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">r2yz_dx</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Adjusted t-value given hypothetical strength of confounder</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bias_functions</span><span class="o">.</span><span class="n">adjusted_t</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">fitted_model</span><span class="p">,</span> <span class="n">treatment</span> <span class="o">=</span> <span class="s2">&quot;directlyharmed&quot;</span><span class="p">,</span> <span class="n">r2dz_x</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">r2yz_dx</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Bias contour plot directly from model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ovb_plots</span><span class="o">.</span><span class="n">ovb_contour_plot</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">fitted_model</span><span class="p">,</span> <span class="n">treatment</span> <span class="o">=</span> <span class="s2">&quot;directlyharmed&quot;</span><span class="p">,</span> <span class="n">benchmark_covariates</span> <span class="o">=</span> <span class="s2">&quot;female&quot;</span><span class="p">,</span> <span class="n">kd</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Extreme scenario plot directly from model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ovb_plots</span><span class="o">.</span><span class="n">ovb_extreme_plot</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">fitted_model</span><span class="p">,</span> <span class="n">treatment</span> <span class="o">=</span> <span class="s2">&quot;directlyharmed&quot;</span><span class="p">,</span> <span class="n">benchmark_covariates</span> <span class="o">=</span> <span class="s2">&quot;female&quot;</span><span class="p">,</span> <span class="n">kd</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">lim</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">)</span>
</pre></div>
</div>
<section id="module-sensemakr.sensemakr">
<span id="sensemakr-sensemakr"></span><h1>sensemakr.sensemakr<a class="headerlink" href="#module-sensemakr.sensemakr" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="sensemakr.sensemakr.Sensemakr">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sensemakr.sensemakr.</span></span><span class="sig-name descname"><span class="pre">Sensemakr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">treatment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">benchmark_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ky</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r2dz_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r2yz_dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r2dxj_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r2yxj_dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bound_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Manual</span> <span class="pre">Bound'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sensemakr/sensemakr.html#Sensemakr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sensemakr.sensemakr.Sensemakr" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Sensitivity analysis to unobserved confounders.</p>
<p>This function performs sensitivity analysis to omitted variables as discussed in Cinelli and Hazlett (2020).
It returns an object of class Sensemakr with several pre-computed sensitivity statistics for reporting.
After creating the object, you may directly use the plot and summary methods of the returned object.</p>
<p>Sensemakr is a convenience class. You may use the other sensitivity functions of the package directly,
such as the functions for sensitivity plots (ovb_contour_plot, ovb_extreme_plot), the functions for
computing bias-adjusted estimates and t-values (adjusted_estimate, adjusted_t), the functions for computing the
robustness value and partial R2 (robustness_value, partial_r2),  or the functions for bounding the strength
of unobserved confounders (ovb_bounds), among others.</p>
<p><strong>Parameters</strong>
arguments passed to other methods. First argument should either be</p>
<ul class="simple">
<li><p>a statsmodels OLSResults object (&quot;fitted_model&quot;); or</p></li>
<li><p>the numerical estimated value of the coefficient, along with the numeric values of standard errors and
degrees of freedom (arguments estimate, se and df).</p></li>
</ul>
<p><strong>Return:</strong>
An object of class Sensemakr, containing:</p>
<ul class="simple">
<li><p>sensitivity_stats : A Pandas DataFrame with the sensitivity statistics for the treatment variable,
as computed by the function sensitivity_stats.</p></li>
<li><p>bounds : A pandas DataFrame with bounds on the strength of confounding according to some benchmark covariates,
as computed by the function ovb_bounds.</p></li>
</ul>
<p><strong>Reference:</strong>
Cinelli, C. and Hazlett, C. (2020), &quot;Making Sense of Sensitivity: Extending Omitted Variable Bias.&quot;
Journal of the Royal Statistical Society, Series B (Statistical Methodology).</p>
<p><strong>Examples:</strong></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load example dataset:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">darfur</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">load_darfur</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Fit a statsmodels OLSResults object (&quot;fitted_model&quot;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s1">&#39;peacefactor ~ </span><span class="se">\</span>
<span class="go">        directlyharmed + age + farmer_dar + herder_dar + pastvoted + hhsize_darfur + female + village&#39;, data=darfur)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fitted_model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Runs sensemakr for sensitivity analysis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">sensemakr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sensitivity</span> <span class="o">=</span> <span class="n">sensemakr</span><span class="o">.</span><span class="n">Sensemakr</span><span class="p">(</span>
<span class="go">        fitted_model, treatment = &quot;directlyharmed&quot;, benchmark_covariates = &quot;female&quot;, kd = [1, 2, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Description of results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sensitivity</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot bias contour of point estimate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">ovb_plots</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ovb_plots</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sensitivity</span><span class="p">,</span><span class="n">plot_type</span> <span class="o">=</span> <span class="s2">&quot;contour&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot extreme scenario</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ovb_plots</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sensitivity</span><span class="p">,</span> <span class="n">plot_type</span> <span class="o">=</span> <span class="s2">&quot;extreme&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sensemakr.sensemakr.Sensemakr.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plot_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensitivity_of</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'estimate'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sensemakr/sensemakr.html#Sensemakr.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sensemakr.sensemakr.Sensemakr.plot" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>Description:</strong>
This function provides the contour and extreme scenario sensitivity
plots of the sensitivity analysis results obtained with the function Sensemakr. They are basically dispatchers
to the core plot functions ovb_contour_plot and ovb_extreme_plot.</p>
<p>This function takes as input a sensemakr object and one of the plot type &quot;contour&quot; or &quot;extreme&quot;.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sense_obj</strong> -- a sensemakr object</p></li>
<li><p><strong>plot_type</strong> -- either &quot;extreme&quot; or &quot;contour&quot;</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a plot for the corresponding plot type</p>
</dd>
</dl>
<p><strong>Examples:</strong></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load example dataset:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">darfur</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">load_darfur</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Fit a statsmodels OLSResults object (&quot;fitted_model&quot;):</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s1">&#39;peacefactor ~ directlyharmed + age + farmer_dar</span><span class="se">\</span>
<span class="go">            + herder_dar + pastvoted + hhsize_darfur + female + village&#39;, data=darfur)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fitted_model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Runs sensemakr for sensitivity analysis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">sensemakr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sensitivity</span> <span class="o">=</span> <span class="n">sensemakr</span><span class="o">.</span><span class="n">Sensemakr</span><span class="p">(</span>
<span class="go">        fitted_model, treatment = &quot;directlyharmed&quot;, benchmark_covariates = &quot;female&quot;, kd = [1, 2, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot bias contour of point estimate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">ovb_plots</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ovb_plots</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sensitivity</span><span class="p">,</span><span class="n">plot_type</span><span class="o">=</span><span class="s1">&#39;contour&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot bias contour of t-values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ovb_plots</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sensitivity</span><span class="p">,</span><span class="n">plot_type</span><span class="o">=</span><span class="s1">&#39;contour&#39;</span><span class="p">,</span><span class="n">sensitivity_of</span><span class="o">=</span><span class="s1">&#39;t-value&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot extreme scenario</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ovb_plots</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sensitivity</span><span class="p">,</span> <span class="n">plot_type</span> <span class="o">=</span> <span class="s2">&quot;extreme&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sensemakr.sensemakr.Sensemakr.summary">
<span class="sig-name descname"><span class="pre">summary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">digits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sensemakr/sensemakr.html#Sensemakr.summary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sensemakr.sensemakr.Sensemakr.summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Print a summary of the sensitivity results for a Sensemakr object, including robustness value, extreme
confounding scenario, and benchmark bounding. digits is the number of digits to round numbers to; default is 3.
Following the example above, if you have a Sensemakr object called sensitivity, call this method using
sensitivity.summary(). To round to 5 digits instead of 3, call sensitivity.summary(digits=5).</p>
</dd></dl>

</dd></dl>

</section>
<section id="sensemakr-ovb-plots">
<h1>sensemakr.ovb_plots<a class="headerlink" href="#sensemakr-ovb-plots" title="Permalink to this headline">¶</a></h1>
<section id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>Sensitivity analysis plots for sensemakr. This module provides the contour and extreme scenario sensitivity
plots of the sensitivity analysis results obtained with the function Sensemakr or model or maunually input statistics.</p>
</section>
<section id="reference">
<h2>Reference<a class="headerlink" href="#reference" title="Permalink to this headline">¶</a></h2>
<p>Cinelli, C. and Hazlett, C. (2020), &quot;Making Sense of Sensitivity: Extending Omitted Variable Bias.&quot;
Journal of the Royal Statistical Society, Series B (Statistical Methodology).</p>
</section>
<section id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>See specific functions below.</p>
<dl class="py function">
<dt class="sig sig-object py" id="sensemakr.ovb_plots.ovb_contour_plot">
<span class="sig-prename descclassname"><span class="pre">sensemakr.ovb_plots.</span></span><span class="sig-name descname"><span class="pre">ovb_contour_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sense_obj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensitivity_of</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'estimate'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">treatment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">benchmark_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ky</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r2dz_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r2yz_dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bound_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimate_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lim_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_contour</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'black'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_thr_line</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'red'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_text</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_bump_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_bump_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">list_par</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_margin_fraction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">round_dig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sensemakr/ovb_plots.html#ovb_contour_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sensemakr.ovb_plots.ovb_contour_plot" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>Description:</strong>
Contour plots of omitted variable bias for sensitivity analysis. The main inputs are a statsmodel object, the treatment variable
and the covariates used for benchmarking the strength of unobserved confounding.</p>
<p>The horizontal axis of the plot shows hypothetical values of the partial R2 of the unobserved confounder(s) with the treatment.
The vertical axis shows hypothetical values of the partial R2 of the unobserved confounder(s) with the outcome.
The contour levels represent the adjusted estimates (or t-values) of the treatment effect.</p>
<p>The reference points are the bounds on the partial R2 of the unobserved confounder if it were k times ''as strong'' as the observed covariate used for benchmarking (see arguments kd and ky).
The dotted red line show the chosen critical threshold (for instance, zero): confounders with such strength (or stronger) are sufficient to invalidate the research conclusions.
All results are exact for single confounders and conservative for multiple/nonlinear confounders.</p>
<p>See Cinelli and Hazlett (2020) for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sense_obj</strong> -- a sensemakr object</p></li>
<li><p><strong>sensitivity_of</strong> -- either &quot;estimate&quot; or &quot;t-value&quot;</p></li>
<li><p><strong>model</strong> -- a fitted statsmodels OLSResults object for the restricted regression model you have provided</p></li>
<li><p><strong>treatment</strong> -- a string with the name of the &quot;treatment&quot; variable, e.g. the independent variable of interest</p></li>
<li><p><strong>estimate</strong> -- a float with the estimate of the coefficient for the independent variable of interest</p></li>
<li><p><strong>se</strong> -- a float with the standard error of the regression</p></li>
<li><p><strong>dof</strong> -- an int with the degrees of freedom of the regression</p></li>
<li><p><strong>benchmark_covariates</strong> -- a string or list of strings with
the names of the variables to use for benchmark bounding</p></li>
<li><p><strong>kd</strong> -- a float or list of floats with each being a multiple of the strength of association between a
benchmark variable and the treatment variable to test with benchmark bounding</p></li>
<li><p><strong>ky</strong> -- same as kd except measured in terms of strength of association with the outcome variable</p></li>
<li><p><strong>r2dz_x</strong> -- a float or list of floats with the partial R^2 of a putative unobserved confounder &quot;z&quot;
with the treatment variable &quot;d&quot;, with observed covariates &quot;x&quot; partialed out, as implied by z being kd-times
as strong as the benchmark_covariates</p></li>
<li><p><strong>r2yz_dx</strong> -- a float or list of floats with the partial R^2 of a putative unobserved confounder &quot;z&quot;
with the outcome variable &quot;y&quot;, with observed covariates &quot;x&quot; and the treatment variable &quot;d&quot; partialed out,
as implied by z being ky-times as strong as the benchmark_covariates</p></li>
<li><p><strong>reduce</strong> -- whether to reduce (True, default) or increase (False) the estimate due to putative confounding, default=True</p></li>
<li><p><strong>estimate_threshold</strong> -- threshold line to emphasize when drawing estimate, default=0</p></li>
<li><p><strong>t_threshold</strong> -- threshold line to emphasize when drawing t-value, default=2</p></li>
<li><p><strong>xlab</strong> -- x-axis label text</p></li>
<li><p><strong>ylab</strong> -- y-axis label text</p></li>
<li><p><strong>round_dig</strong> -- rounding digit of the display numbers, default=3</p></li>
<li><p><strong>col_contour</strong> -- color of the contour line, default=&quot;black&quot;</p></li>
<li><p><strong>col_thr_line</strong> -- color of the threshold line, default=&quot;red&quot;</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a contour plot of omitted variable bias for the corresponding model/sense_obj.</p>
</dd>
</dl>
<p><strong>Reference:</strong></p>
<p>Cinelli, C. and Hazlett, C. (2020), &quot;Making Sense of Sensitivity: Extending Omitted Variable Bias.&quot;
Journal of the Royal Statistical Society, Series B (Statistical Methodology).</p>
<p><strong>Examples:</strong></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load example dataset:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">darfur</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">load_darfur</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Fit a statsmodels OLSResults object (&quot;fitted_model&quot;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s1">&#39;peacefactor ~ directlyharmed + age + farmer_dar </span><span class="se">\</span>
<span class="go">             +herder_dar + pastvoted + hhsize_darfur + female + village&#39;, data=darfur)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fitted_model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Runs sensemakr for sensitivity analysis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">sensemakr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sensitivity</span> <span class="o">=</span> <span class="n">sensemakr</span><span class="o">.</span><span class="n">Sensemakr</span><span class="p">(</span>
<span class="go">        fitted_model, treatment = &quot;directlyharmed&quot;, benchmark_covariates = &quot;female&quot;, kd = [1, 2, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot contour of the fitted model with directlyharmed as treatment and &quot;female&quot; as benchmark_covariates.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">ovb_plots</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ovb_plots</span><span class="o">.</span><span class="n">ovb_contour_plot</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">fitted_model</span><span class="p">,</span><span class="n">treatment</span><span class="o">=</span><span class="s1">&#39;directlyharmed&#39;</span><span class="p">,</span><span class="n">benchmark_covariates</span><span class="o">=</span><span class="s1">&#39;female&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot contour of the fitted model with directlyharmed as treatment and &quot;female&quot; as benchmark_covariates kd=[1,2,3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ovb_plots</span><span class="o">.</span><span class="n">ovb_contour_plot</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">fitted_model</span><span class="p">,</span><span class="n">treatment</span><span class="o">=</span><span class="s1">&#39;directlyharmed&#39;</span><span class="p">,</span><span class="n">benchmark_covariates</span><span class="o">=</span><span class="s1">&#39;female&#39;</span><span class="p">,</span><span class="n">kd</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot contour of the fitted model with manual benchmark</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ovb_plots</span><span class="o">.</span><span class="n">ovb_contour_plot</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">fitted_model</span><span class="p">,</span><span class="n">treatment</span><span class="o">=</span><span class="s1">&#39;directlyharmed&#39;</span><span class="p">,</span><span class="n">r2dz_x</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot contour of the sensemakr object</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ovb_plots</span><span class="o">.</span><span class="n">ovb_contour_plot</span><span class="p">(</span><span class="n">sense_obj</span><span class="o">=</span><span class="n">sensitivity</span><span class="p">,</span> <span class="n">sensitivity_of</span><span class="o">=</span><span class="s1">&#39;estimate&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sensemakr.ovb_plots.add_bound_to_contour">
<span class="sig-prename descclassname"><span class="pre">sensemakr.ovb_plots.</span></span><span class="sig-name descname"><span class="pre">add_bound_to_contour</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">benchmark_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ky</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">treatment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r2dz_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r2yz_dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bound_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bound_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensitivity_of</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_text</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_bump_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_bump_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">round_dig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sensemakr/ovb_plots.html#add_bound_to_contour"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sensemakr.ovb_plots.add_bound_to_contour" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>Description:</strong>
Add bound label to the contour plot of omitted variable bias for sensitivity analysis. The main inputs are a statsmodel object, the treatment variable
and the covariates used for benchmarking the strength of unobserved confounding.</p>
<p>The reference points are the bounds on the partial R2 of the unobserved confounder if it were k times ''as strong'' as the observed covariate used for benchmarking (see arguments kd and ky).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sensitivity_of</strong> -- either &quot;estimate&quot; or &quot;t-value&quot;</p></li>
<li><p><strong>model</strong> -- a fitted statsmodels OLSResults object for the restricted regression model you have provided</p></li>
<li><p><strong>treatment</strong> -- a string with the name of the &quot;treatment&quot; variable, e.g. the independent variable of interest</p></li>
<li><p><strong>benchmark_covariates</strong> -- a string or list of strings with
the names of the variables to use for benchmark bounding</p></li>
<li><p><strong>kd</strong> -- a float or list of floats with each being a multiple of the strength of association between a
benchmark variable and the treatment variable to test with benchmark bounding</p></li>
<li><p><strong>ky</strong> -- same as kd except measured in terms of strength of association with the outcome variable</p></li>
<li><p><strong>r2dz_x</strong> -- a float or list of floats with the partial R^2 of a putative unobserved confounder &quot;z&quot;
with the treatment variable &quot;d&quot;, with observed covariates &quot;x&quot; partialed out, as implied by z being kd-times
as strong as the benchmark_covariates</p></li>
<li><p><strong>r2yz_dx</strong> -- a float or list of floats with the partial R^2 of a putative unobserved confounder &quot;z&quot;
with the outcome variable &quot;y&quot;, with observed covariates &quot;x&quot; and the treatment variable &quot;d&quot; partialed out,
as implied by z being ky-times as strong as the benchmark_covariates</p></li>
<li><p><strong>bound_value</strong> -- the value of the reference point</p></li>
<li><p><strong>bound_label</strong> -- a string that label the reference point</p></li>
<li><p><strong>round_dig</strong> -- rounding digit of the display numbers, default=3</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>add a bound label to the existing contour plot.</p>
</dd>
</dl>
<p><strong>Examples:</strong></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load example dataset:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">darfur</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">load_darfur</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Fit a statsmodels OLSResults object (&quot;fitted_model&quot;):</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s1">&#39;peacefactor ~ directlyharmed + age + farmer_dar </span><span class="se">\</span>
<span class="go">            + herder_dar + pastvoted + hhsize_darfur + female + village&#39;, data=darfur)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fitted_model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Runs sensemakr for sensitivity analysis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">sensemakr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sensitivity</span> <span class="o">=</span> <span class="n">sensemakr</span><span class="o">.</span><span class="n">Sensemakr</span><span class="p">(</span>
<span class="go">        fitted_model, treatment = &quot;directlyharmed&quot;, benchmark_covariates = &quot;female&quot;, kd = [1, 2, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot contour of the fitted model with directlyharmed as treatment and &quot;female&quot; as benchmark_covariates.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">ovb_plots</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ovb_plots</span><span class="o">.</span><span class="n">ovb_contour_plot</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">fitted_model</span><span class="p">,</span><span class="n">treatment</span><span class="o">=</span><span class="s1">&#39;directlyharmed&#39;</span><span class="p">,</span><span class="n">benchmark_covariates</span><span class="o">=</span><span class="s1">&#39;female&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add bound to contour.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ovb_plots</span><span class="o">.</span><span class="n">add_bound_to_contour</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">fitted_model</span><span class="p">,</span><span class="n">treatment</span><span class="o">=</span><span class="s1">&#39;directlyharmed&#39;</span><span class="p">,</span><span class="n">benchmark_covariates</span><span class="o">=</span><span class="s1">&#39;female&#39;</span><span class="p">,</span><span class="n">kd</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sensemakr.ovb_plots.ovb_extreme_plot">
<span class="sig-prename descclassname"><span class="pre">sensemakr.ovb_plots.</span></span><span class="sig-name descname"><span class="pre">ovb_extreme_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sense_obj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">treatment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">benchmark_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ky</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r2dz_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r2yz_dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1,</span> <span class="pre">0.75,</span> <span class="pre">0.5]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lim_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">list_par</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sensemakr/ovb_plots.html#ovb_extreme_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sensemakr.ovb_plots.ovb_extreme_plot" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>Description:</strong></p>
<p>Extreme scenario plots of omitted variable bias for sensitivity analysis. The main inputs are a statsmodel object, the treatment variable
and the covariates used for benchmarking the strength of unobserved confounding.</p>
<p>The horizontal axis shows the partial R2 of the unobserved confounder(s) with the treatment. The vertical axis shows the adjusted treatment effect estimate.
The partial R2 of the confounder with the outcome is represented by different curves for each scenario, as given by the parameter r2yz_dx.
The red marks on horizontal axis are bounds on the partial R2 of the unobserved confounder kd times as strong as the covariates used for benchmarking.
The dotted red line represent the threshold for the effect estimate deemed to be problematic (for instance, zero).</p>
<p>See Cinelli and Hazlett (2020) for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sense_obj</strong> -- a sensemakr object</p></li>
<li><p><strong>model</strong> -- a fitted statsmodels OLSResults object for the restricted regression model you have provided</p></li>
<li><p><strong>treatment</strong> -- a string with the name of the &quot;treatment&quot; variable, e.g. the independent variable of interest</p></li>
<li><p><strong>estimate</strong> -- a float with the estimate of the coefficient for the independent variable of interest</p></li>
<li><p><strong>se</strong> -- a float with the standard error of the regression</p></li>
<li><p><strong>dof</strong> -- an int with the degrees of freedom of the regression</p></li>
<li><p><strong>benchmark_covariates</strong> -- a string or list of strings with
the names of the variables to use for benchmark bounding</p></li>
<li><p><strong>kd</strong> -- a float or list of floats with each being a multiple of the strength of association between a
benchmark variable and the treatment variable to test with benchmark bounding</p></li>
<li><p><strong>ky</strong> -- same as kd except measured in terms of strength of association with the outcome variable</p></li>
<li><p><strong>r2dz_x</strong> -- a float or list of floats with the partial R^2 of a putative unobserved confounder &quot;z&quot;
with the treatment variable &quot;d&quot;, with observed covariates &quot;x&quot; partialed out, as implied by z being kd-times
as strong as the benchmark_covariates</p></li>
<li><p><strong>r2yz_dx</strong> -- a float or list of floats with the partial R^2 of a putative unobserved confounder &quot;z&quot;
with the outcome variable &quot;y&quot;, with observed covariates &quot;x&quot; and the treatment variable &quot;d&quot; partialed out,
as implied by z being ky-times as strong as the benchmark_covariates, default=[1,0.75,0.5]</p></li>
<li><p><strong>reduce</strong> -- whether to reduce (True, default) or increase (False) the estimate due to putative confounding, default=True</p></li>
<li><p><strong>threshold</strong> -- threshold line to emphasize when drawing estimate, default=0</p></li>
<li><p><strong>xlab</strong> -- x-axis label text</p></li>
<li><p><strong>ylab</strong> -- y-axis label text</p></li>
<li><p><strong>lim</strong> -- range of x-axis</p></li>
<li><p><strong>lim_y</strong> -- range of y-axis</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>an extreme value plot of omitted variable bias for the corresponding model/sense_obj.</p>
</dd>
</dl>
<p><strong>Reference:</strong></p>
<p>Cinelli, C. and Hazlett, C. (2020), &quot;Making Sense of Sensitivity: Extending Omitted Variable Bias.&quot;
Journal of the Royal Statistical Society, Series B (Statistical Methodology).</p>
<p><strong>Examples:</strong></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load example dataset:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">darfur</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">load_darfur</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Fit a statsmodels OLSResults object (&quot;fitted_model&quot;):</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s1">&#39;peacefactor ~ directlyharmed + age + farmer_dar </span><span class="se">\</span>
<span class="go">            + herder_dar + pastvoted + hhsize_darfur + female + village&#39;, data=darfur)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fitted_model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Runs sensemakr for sensitivity analysis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">sensemakr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sensitivity</span> <span class="o">=</span> <span class="n">sensemakr</span><span class="o">.</span><span class="n">Sensemakr</span><span class="p">(</span>
<span class="go">        fitted_model, treatment = &quot;directlyharmed&quot;, benchmark_covariates = &quot;female&quot;, kd = [1, 2, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot extreme value of the fitted model with directlyharmed as treatment and &quot;female&quot; as benchmark_covariates.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">ovb_plots</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ovb_plots</span><span class="o">.</span><span class="n">ovb_extreme_plot</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">fitted_model</span><span class="p">,</span><span class="n">treatment</span><span class="o">=</span><span class="s1">&#39;directlyharmed&#39;</span><span class="p">,</span><span class="n">benchmark_covariates</span><span class="o">=</span><span class="s1">&#39;female&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot extreme value of the fitted model with directlyharmed as treatment and &quot;female&quot; as benchmark_covariates kd=[1,2].</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ovb_plots</span><span class="o">.</span><span class="n">ovb_extreme_plot</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">fitted_model</span><span class="p">,</span><span class="n">treatment</span><span class="o">=</span><span class="s1">&#39;directlyharmed&#39;</span><span class="p">,</span><span class="n">benchmark_covariates</span><span class="o">=</span><span class="s1">&#39;female&#39;</span><span class="p">,</span><span class="n">kd</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot extreme value of the fitted model with manual benchmark</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ovb_plots</span><span class="o">.</span><span class="n">ovb_extreme_plot</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">fitted_model</span><span class="p">,</span><span class="n">treatment</span><span class="o">=</span><span class="s1">&#39;directlyharmed&#39;</span><span class="p">,</span><span class="n">r2dz_x</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot extreme value of the sensemakr object</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ovb_plots</span><span class="o">.</span><span class="n">ovb_extreme_plot</span><span class="p">(</span><span class="n">sense_obj</span><span class="o">=</span><span class="n">sensitivity</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sensemakr.ovb_plots.plot">
<span class="sig-prename descclassname"><span class="pre">sensemakr.ovb_plots.</span></span><span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sense_obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensitivity_of</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'estimate'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sensemakr/ovb_plots.html#plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sensemakr.ovb_plots.plot" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>Description:</strong>
This function provides the contour and extreme scenario sensitivity
plots of the sensitivity analysis results obtained with the function Sensemakr. They are basically dispatchers
to the core plot functions ovb_contour_plot and ovb_extreme_plot.</p>
<p>This function takes as input a sensemakr object and one of the plot type &quot;contour&quot; or &quot;extreme&quot;.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sense_obj</strong> -- a sensemakr object</p></li>
<li><p><strong>plot_type</strong> -- either &quot;extreme&quot; or &quot;contour&quot;</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a plot for the corresponding plot type</p>
</dd>
</dl>
<p><strong>Examples:</strong></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load example dataset:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">darfur</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">load_darfur</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Fit a statsmodels OLSResults object (&quot;fitted_model&quot;):</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s1">&#39;peacefactor ~ directlyharmed + age + farmer_dar</span><span class="se">\</span>
<span class="go">            + herder_dar + pastvoted + hhsize_darfur + female + village&#39;, data=darfur)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fitted_model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Runs sensemakr for sensitivity analysis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">sensemakr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sensitivity</span> <span class="o">=</span> <span class="n">sensemakr</span><span class="o">.</span><span class="n">Sensemakr</span><span class="p">(</span>
<span class="go">        fitted_model, treatment = &quot;directlyharmed&quot;, benchmark_covariates = &quot;female&quot;, kd = [1, 2, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot bias contour of point estimate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">ovb_plots</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ovb_plots</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sensitivity</span><span class="p">,</span><span class="n">plot_type</span><span class="o">=</span><span class="s1">&#39;contour&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot bias contour of t-values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ovb_plots</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sensitivity</span><span class="p">,</span><span class="n">plot_type</span><span class="o">=</span><span class="s1">&#39;contour&#39;</span><span class="p">,</span><span class="n">sensitivity_of</span><span class="o">=</span><span class="s1">&#39;t-value&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot extreme scenario</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ovb_plots</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sensitivity</span><span class="p">,</span> <span class="n">plot_type</span> <span class="o">=</span> <span class="s2">&quot;extreme&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>
<section id="module-sensemakr.bias_functions">
<span id="sensemakr-bias-functions"></span><h1>sensemakr.bias_functions<a class="headerlink" href="#module-sensemakr.bias_functions" title="Permalink to this headline">¶</a></h1>
<section id="id1">
<h2>Description<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>Compute bias-adjusted estimates, standard-errors, and t-values.</p>
<p>All methods in the script below have similar purposes and parameters, so they are all described here.</p>
<p>These functions compute bias adjusted estimates (adjusted_estimate), standard-errors (adjusted_se),
and t-values (adjusted_t), given a hypothetical strength of the confounder in the partial R2 parameterization.</p>
<p>The functions work either with a statsmodels OLSResults object, or directly passing in numerical inputs, such as the
current coefficient estimate, standard error and degrees of freedom.</p>
<p>They return a numpy array with the adjusted estimate, standard error, or t-value for each partial R2 passed in.</p>
<p>Internally, we also have functions defined to compute the bias and relative_bias, given the same arguments. We also
define internal functions to compute the bias function and relative bias function for the partial R2 parameters.</p>
<p>Finally, in the python version of the package, there is a param_check method which validates all the parameters, since
they are roughly the same for each method.</p>
</section>
<section id="parameters">
<h2>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline">¶</a></h2>
<p>For all methods, r2dz_x and r2yz_dx are required. For all methods other than bf, either model and treatment
or estimate, se, and dof are also required, except adjused_se and bias which do not accept the estimate parameter.</p>
<section id="list-of-parameters">
<h3>List of parameters<a class="headerlink" href="#list-of-parameters" title="Permalink to this headline">¶</a></h3>
<dl class="simple">
<dt>r2dz_x :</dt><dd><p>a float or list of floats with the partial R^2 of a putative unobserved confounder &quot;z&quot; with the treatment variable &quot;d&quot;, with observed covariates &quot;x&quot; partialed out.</p>
</dd>
<dt>r2yz_dx :</dt><dd><p>a float or list of floats with the  partial R^2 of a putative unobserved confounder &quot;z&quot; with the outcome variable &quot;y&quot;, with observed covariates &quot;x&quot; and treatment variable &quot;d&quot; partialed out.</p>
</dd>
<dt>model :</dt><dd><p>a fitted statsmodels OLSResults object for the restricted regression model you have provided</p>
</dd>
<dt>treatment :</dt><dd><p>a string with the name of the &quot;treatment&quot; variable, e.g. the independent variable of interest</p>
</dd>
<dt>estimate :</dt><dd><p>a float with the unadjusted estimate of the coefficient for the independent variable of interest</p>
</dd>
<dt>se :</dt><dd><p>a float with the unadjusted standard error of the regression</p>
</dd>
<dt>dof :</dt><dd><p>an int with the degrees of freedom of the regression</p>
</dd>
<dt>reduce :</dt><dd><p>whether to reduce (True, default) or increase (False) the estimate due to putative confounding</p>
</dd>
</dl>
</section>
<section id="parameters-only-used-in-param-check">
<h3>Parameters only used in param_check<a class="headerlink" href="#parameters-only-used-in-param-check" title="Permalink to this headline">¶</a></h3>
<dl class="simple">
<dt>function_name :</dt><dd><p>string with the name of the calling function, used to print the function name in error messages</p>
</dd>
<dt>estimate_is_param :</dt><dd><p>flag for whether estimate should be a required parameter for the calling function</p>
</dd>
<dt>reduce_is_param :</dt><dd><p>flag for whether reduce is a parameter for the calling function</p>
</dd>
</dl>
</section>
</section>
<section id="id2">
<h2>Reference<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>Cinelli, C. and Hazlett, C. (2020), &quot;Making Sense of Sensitivity: Extending Omitted Variable Bias.&quot; Journal of the Royal Statistical Society, Series B (Statistical Methodology).</p>
</section>
<section id="id3">
<h2>Example<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load example dataset and fit a statsmodels OLSResults object (&quot;fitted_model&quot;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">darfur</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">load_darfur</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Fit a statsmodels OLSResults object (&quot;fitted_model&quot;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s1">&#39;peacefactor ~ directlyharmed + age + farmer_dar </span><span class="se">\</span>
<span class="go">            + herder_dar + pastvoted + hhsize_darfur + female + village&#39;, data=darfur)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fitted_model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Import this module</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">bias_functions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Computes adjusted estimate for confounder with  r2dz_x = 0.05, r2yz_dx = 0.05</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bias_functions</span><span class="o">.</span><span class="n">adjusted_estimate</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">fitted_model</span><span class="p">,</span> <span class="n">treatment</span> <span class="o">=</span> <span class="s2">&quot;directlyharmed&quot;</span><span class="p">,</span> <span class="n">r2dz_x</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">r2yz_dx</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Computes adjusted SE for confounder with  r2dz_x = 0.05, r2yz_dx = 0.05</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bias_functions</span><span class="o">.</span><span class="n">adjusted_se</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">fitted_model</span><span class="p">,</span> <span class="n">treatment</span> <span class="o">=</span> <span class="s2">&quot;directlyharmed&quot;</span><span class="p">,</span> <span class="n">r2dz_x</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">r2yz_dx</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Computes adjusted t-value for confounder with  r2dz_x = 0.05, r2yz_dx = 0.05</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bias_functions</span><span class="o">.</span><span class="n">adjusted_t</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">fitted_model</span><span class="p">,</span> <span class="n">treatment</span> <span class="o">=</span> <span class="s2">&quot;directlyharmed&quot;</span><span class="p">,</span> <span class="n">r2dz_x</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">r2yz_dx</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Alternatively, pass in numerical values directly.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bias_functions</span><span class="o">.</span><span class="n">adjusted_estimate</span><span class="p">(</span><span class="n">estimate</span> <span class="o">=</span> <span class="mf">0.09731582</span><span class="p">,</span> <span class="n">se</span> <span class="o">=</span> <span class="mf">0.02325654</span><span class="p">,</span> <span class="n">dof</span> <span class="o">=</span> <span class="mi">783</span><span class="p">,</span> <span class="n">r2dz_x</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">r2yz_dx</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bias_functions</span><span class="o">.</span><span class="n">adjusted_se</span><span class="p">(</span><span class="n">se</span> <span class="o">=</span> <span class="mf">0.02325654</span><span class="p">,</span> <span class="n">dof</span> <span class="o">=</span> <span class="mi">783</span><span class="p">,</span> <span class="n">r2dz_x</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">r2yz_dx</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bias_functions</span><span class="o">.</span><span class="n">adjusted_t</span><span class="p">(</span><span class="n">estimate</span> <span class="o">=</span> <span class="mf">0.09731582</span><span class="p">,</span> <span class="n">se</span> <span class="o">=</span> <span class="mf">0.02325654</span><span class="p">,</span> <span class="n">dof</span> <span class="o">=</span> <span class="mi">783</span><span class="p">,</span> <span class="n">r2dz_x</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">r2yz_dx</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py function">
<dt class="sig sig-object py" id="sensemakr.bias_functions.adjusted_estimate">
<span class="sig-prename descclassname"><span class="pre">sensemakr.bias_functions.</span></span><span class="sig-name descname"><span class="pre">adjusted_estimate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r2dz_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r2yz_dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">treatment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sensemakr/bias_functions.html#adjusted_estimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sensemakr.bias_functions.adjusted_estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the bias-adjusted coefficient estimate. See description at top for details.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sensemakr.bias_functions.adjusted_partial_r2">
<span class="sig-prename descclassname"><span class="pre">sensemakr.bias_functions.</span></span><span class="sig-name descname"><span class="pre">adjusted_partial_r2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r2dz_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r2yz_dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">treatment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sensemakr/bias_functions.html#adjusted_partial_r2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sensemakr.bias_functions.adjusted_partial_r2" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the bias-adjusted partial R2, based on adjusted_t. See description at top for details.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sensemakr.bias_functions.adjusted_se">
<span class="sig-prename descclassname"><span class="pre">sensemakr.bias_functions.</span></span><span class="sig-name descname"><span class="pre">adjusted_se</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r2dz_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r2yz_dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">treatment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sensemakr/bias_functions.html#adjusted_se"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sensemakr.bias_functions.adjusted_se" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the bias-adjusted regression standard error. See description at top for details.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sensemakr.bias_functions.adjusted_t">
<span class="sig-prename descclassname"><span class="pre">sensemakr.bias_functions.</span></span><span class="sig-name descname"><span class="pre">adjusted_t</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r2dz_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r2yz_dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">treatment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sensemakr/bias_functions.html#adjusted_t"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sensemakr.bias_functions.adjusted_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute bias-adjusted t-statistic, (adjusted_estimate - h0) / adjusted_se. See description at top for details.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sensemakr.bias_functions.bf">
<span class="sig-prename descclassname"><span class="pre">sensemakr.bias_functions.</span></span><span class="sig-name descname"><span class="pre">bf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r2dz_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r2yz_dx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sensemakr/bias_functions.html#bf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sensemakr.bias_functions.bf" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the bias function for the partial R2 parameters. See description at top for details.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sensemakr.bias_functions.bias">
<span class="sig-prename descclassname"><span class="pre">sensemakr.bias_functions.</span></span><span class="sig-name descname"><span class="pre">bias</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r2dz_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r2yz_dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">treatment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sensemakr/bias_functions.html#bias"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sensemakr.bias_functions.bias" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the omitted variable bias for the partial R2 parameterization. See description at top for details.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sensemakr.bias_functions.param_check">
<span class="sig-prename descclassname"><span class="pre">sensemakr.bias_functions.</span></span><span class="sig-name descname"><span class="pre">param_check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r2dz_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r2yz_dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">treatment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimate_is_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_is_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sensemakr/bias_functions.html#param_check"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sensemakr.bias_functions.param_check" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper method that checks whether the required parameters have been passed in and have valid values.
Also extracts data from a statsmodels OLSResults object (if one is given) for use in numerical formulae.
See description at top for details.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sensemakr.bias_functions.rel_bias">
<span class="sig-prename descclassname"><span class="pre">sensemakr.bias_functions.</span></span><span class="sig-name descname"><span class="pre">rel_bias</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r_est</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">est</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sensemakr/bias_functions.html#rel_bias"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sensemakr.bias_functions.rel_bias" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the relative bias for any estimator and the truth value.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sensemakr.bias_functions.relative_bias">
<span class="sig-prename descclassname"><span class="pre">sensemakr.bias_functions.</span></span><span class="sig-name descname"><span class="pre">relative_bias</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r2dz_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r2yz_dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">treatment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sensemakr/bias_functions.html#relative_bias"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sensemakr.bias_functions.relative_bias" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the relative bias for the partial R2 parameterization. See description at top for details.</p>
</dd></dl>

</section>
</section>
<section id="sensemakr-sensitivity-stats">
<h1>sensemakr.sensitivity_stats<a class="headerlink" href="#sensemakr-sensitivity-stats" title="Permalink to this headline">¶</a></h1>
<section id="id4">
<h2>Description<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>Computes the sensitivity statistics: robustness value, partial R2, and Cohen's f2; plus helper functions</p>
</section>
<section id="id5">
<h2>Reference<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<p>Cinelli, C. and Hazlett, C. (2020), &quot;Making Sense of Sensitivity: Extending Omitted Variable Bias.&quot; Journal of the Royal Statistical Society, Series B (Statistical Methodology).</p>
</section>
<section id="id6">
<h2>Example<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h2>
<p>See specific functions below.</p>
<dl class="py function">
<dt class="sig sig-object py" id="sensemakr.sensitivity_stats.robustness_value">
<span class="sig-prename descclassname"><span class="pre">sensemakr.sensitivity_stats.</span></span><span class="sig-name descname"><span class="pre">robustness_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_statistic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sensemakr/sensitivity_stats.html#robustness_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sensemakr.sensitivity_stats.robustness_value" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>Description:</strong>
This function computes the robustness value of a regression coefficient. The robustness value describes the
minimum strength of association (parameterized in terms of partial R2) that omitted variables would need to have
both with the treatment and with the outcome to change the estimated coefficient by a certain amount
(for instance, to bring it down to zero).</p>
<p>For instance, a robustness value of 1% means that an unobserved confounder that explain 1% of the residual variance
of the outcome and 1% of the residual variance of the treatment is strong enough to explain away the estimated
effect. Whereas a robustness value of 90% means that any unobserved confounder that explain less than 90% of the
residual variance of both the outcome and the treatment assignment cannot fully account for the observed effect.
You may also compute robustness value taking into account sampling uncertainty.
See details in Cinelli and Hazlett (2020).</p>
<p>The function robustness_value can take as input a statsmodels OLSResults object or you may directly pass
the t-value and degrees of freedom.</p>
<p><strong>Required parameters:</strong> either model or t_statistic and dof.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> -- a statsmodels OLSResults object containing the restricted regression</p></li>
<li><p><strong>t_statistic</strong> -- a float with the t_statistic for the restricted model regression</p></li>
<li><p><strong>dof</strong> -- an int with the degrees of freedom of the restricted regression</p></li>
<li><p><strong>q</strong> -- a float with the percent to reduce the point estimate by for the robustness value RV_q</p></li>
<li><p><strong>alpha</strong> -- a float with the significance level for the robustness value RV_qa to render the estimate not significant</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a numpy array with the robustness value</p>
</dd>
</dl>
<p><strong>Reference:</strong></p>
<p>Cinelli, C. and Hazlett, C. (2020), &quot;Making Sense of Sensitivity: Extending Omitted Variable Bias.&quot;
Journal of the Royal Statistical Society, Series B (Statistical Methodology).</p>
<p><strong>Examples:</strong></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load example dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">darfur</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">load_darfur</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Fit a statsmodels OLSResults object (&quot;fitted_model&quot;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s1">&#39;peacefactor ~ directlyharmed + age + farmer_dar </span><span class="se">\</span>
<span class="go">    + herder_dar + pastvoted + hhsize_darfur + female + village&#39;, data=darfur)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fitted_model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">sensitivity_stats</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Robustness value of directly harmed q =1 (reduce estimate to zero):</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sensitivity_stats</span><span class="o">.</span><span class="n">robustness_value</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">fitted_model</span><span class="p">,</span> <span class="n">covariates</span> <span class="o">=</span> <span class="s2">&quot;directlyharmed&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Robustness value of directly harmed q = 1/2 (reduce estimate in half):</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sensitivity_stats</span><span class="o">.</span><span class="n">robustness_value</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">fitted_model</span><span class="p">,</span> <span class="n">covariates</span> <span class="o">=</span> <span class="s2">&quot;directlyharmed&quot;</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Robustness value of directly harmed q = 1/2, alpha = 0.05 (reduce estimate in half, with 95% confidence):</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sensitivity_stats</span><span class="o">.</span><span class="n">robustness_value</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">fitted_model</span><span class="p">,</span> <span class="n">covariates</span> <span class="o">=</span> <span class="s2">&quot;directlyharmed&quot;</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># You can also provide the statistics directly:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sensitivity_stats</span><span class="o">.</span><span class="n">robustness_value</span><span class="p">(</span><span class="n">t_statistic</span> <span class="o">=</span> <span class="mf">4.18445</span><span class="p">,</span> <span class="n">dof</span> <span class="o">=</span> <span class="mi">783</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sensemakr.sensitivity_stats.sensitivity_stats">
<span class="sig-prename descclassname"><span class="pre">sensemakr.sensitivity_stats.</span></span><span class="sig-name descname"><span class="pre">sensitivity_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">treatment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sensemakr/sensitivity_stats.html#sensitivity_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sensemakr.sensitivity_stats.sensitivity_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function that computes the robustness_value, partial_r2 and partial_f2 of the coefficient of interest.
See those function descriptions above for more details.</p>
<p><strong>Required parameters:</strong> either model and treatment, or (estimate, se, and dof).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> -- a statsmodels OLSResults object containing the restricted regression</p></li>
<li><p><strong>treatment</strong> -- a string with treatment variable name</p></li>
<li><p><strong>estimate</strong> -- a float with the coefficient estimate of the restricted regression</p></li>
<li><p><strong>se</strong> -- a float with the standard error of the restricted regression</p></li>
<li><p><strong>dof</strong> -- an int with the degrees of freedom of the restricted regression</p></li>
<li><p><strong>q</strong> -- a float with the percent to reduce the point estimate by for the robustness value RV_q</p></li>
<li><p><strong>alpha</strong> -- a float with the significance level for the robustness value RV_qa to render the estimate not significant</p></li>
<li><p><strong>reduce</strong> -- whether to reduce or increase the estimate due to confounding</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>a Pandas DataFrame containing the following quantities:</p>
<ul class="simple">
<li><p>treatment : a string with the name of the treatment variable</p></li>
<li><p>estimate : a float with the estimated effect of the treatment</p></li>
<li><p>se : a float with the estimated standard error of the treatment effect</p></li>
<li><p>t_statistics : a float with  the t-value of the treatment</p></li>
<li><p>r2yd.x : a float with the partial R2 of the treatment and the outcome, see details in partial_r2</p></li>
<li><p>rv_q : a float the robustness value of the treatment, see details in robustness_value</p></li>
<li><p>rv_qa : a float with the robustness value of the treatment considering statistical significance, see details in robustness_value</p></li>
<li><p>f2yd_x : a float with the partial (Cohen's) f2 of the treatment with the outcome, see details in partial_f2</p></li>
<li><p>dof : an int with the degrees of freedom of the model</p></li>
</ul>
</p>
</dd>
</dl>
<p><strong>Examples:</strong></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load example dataset:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">darfur</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">load_darfur</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Fit a statsmodels OLSResults object (&quot;fitted_model&quot;):</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s1">&#39;peacefactor ~ directlyharmed + age + farmer_dar </span><span class="se">\</span>
<span class="go">            + herder_dar + pastvoted + hhsize_darfur + female + village&#39;, data=darfur)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fitted_model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">sensitivity_stats</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Sensitivity stats for directly harmed:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sensitivity_stats</span><span class="o">.</span><span class="n">sensitivity_stats</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">fitted_model</span><span class="p">,</span> <span class="n">treatment</span> <span class="o">=</span> <span class="s2">&quot;directlyharmed&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># You can  also pass the numeric values directly:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sensitivity_stats</span><span class="o">.</span><span class="n">sensitivity_stats</span><span class="p">(</span><span class="n">estimate</span> <span class="o">=</span> <span class="mf">0.09731582</span><span class="p">,</span> <span class="n">se</span> <span class="o">=</span> <span class="mf">0.02325654</span><span class="p">,</span> <span class="n">dof</span> <span class="o">=</span> <span class="mi">783</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Reference:</strong></p>
<p>Cinelli, C. and Hazlett, C. (2020), &quot;Making Sense of Sensitivity: Extending Omitted Variable Bias.&quot;
Journal of the Royal Statistical Society, Series B (Statistical Methodology).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sensemakr.sensitivity_stats.partial_r2">
<span class="sig-prename descclassname"><span class="pre">sensemakr.sensitivity_stats.</span></span><span class="sig-name descname"><span class="pre">partial_r2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_statistic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sensemakr/sensitivity_stats.html#partial_r2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sensemakr.sensitivity_stats.partial_r2" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>Description:</strong>
This function computes the partial R2 for a linear regression model. The partial R2 describes how much of the
residual variance of the outcome (after partialing out the other covariates) a covariate explains.</p>
<p>The partial R2 can be used as an extreme-scenario sensitivity analysis to omitted variables.
Considering an unobserved confounder that explains 100% of the residual variance of the outcome,
the partial R2 describes how strongly associated with the treatment this unobserved confounder would need to be
in order to explain away the estimated effect.
For details see Cinelli and Hazlett (2020).</p>
<p><strong>Required parameters:</strong> either model or t_statistic and dof.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> -- a statsmodels OLSResults object containing the restricted regression</p></li>
<li><p><strong>covariates</strong> -- a string or list of strings with the covariates used to compute the t_statistic and dof
from the model. If not specified, defaults to all variables.</p></li>
<li><p><strong>t_statistic</strong> -- a float with the t_statistic for the restricted model regression</p></li>
<li><p><strong>dof</strong> -- an int with the degrees of freedom of the restricted regression</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a float with the computed partial R^2</p>
</dd>
</dl>
<p><strong>Reference:</strong></p>
<p>Cinelli, C. and Hazlett, C. (2020), &quot;Making Sense of Sensitivity: Extending Omitted Variable Bias.&quot;
Journal of the Royal Statistical Society, Series B (Statistical Methodology).</p>
<p><strong>Examples:</strong>
This function takes as input a statsmodels OLSResults object or you may pass directly t-value &amp; degrees of freedom.
For partial R2 of groups of covariates, check group_partial_r2.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load example dataset:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">darfur</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">load_darfur</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Fit a statsmodels OLSResults object (&quot;fitted_model&quot;):</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s1">&#39;peacefactor ~ directlyharmed + age + farmer_dar </span><span class="se">\</span>
<span class="go">            + herder_dar + pastvoted + hhsize_darfur + female + village&#39;, data=darfur)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fitted_model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load this module:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">sensitivity_stats</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Partial R2 of directly harmed with peacefactor:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sensitivity_stats</span><span class="o">.</span><span class="n">partial_r2</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">fitted_model</span><span class="p">,</span> <span class="n">covariates</span> <span class="o">=</span> <span class="s2">&quot;directlyharmed&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Partial R2 of female with peacefactor:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sensitivity_stats</span><span class="o">.</span><span class="n">partial_r2</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">fitted_model</span><span class="p">,</span> <span class="n">covariates</span> <span class="o">=</span> <span class="s2">&quot;female&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># You can also provide the statistics directly:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sensitivity_stats</span><span class="o">.</span><span class="n">partial_r2</span><span class="p">(</span><span class="n">t_statistic</span> <span class="o">=</span> <span class="mf">4.18445</span><span class="p">,</span> <span class="n">dof</span> <span class="o">=</span> <span class="mi">783</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sensemakr.sensitivity_stats.partial_f2">
<span class="sig-prename descclassname"><span class="pre">sensemakr.sensitivity_stats.</span></span><span class="sig-name descname"><span class="pre">partial_f2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_statistic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sensemakr/sensitivity_stats.html#partial_f2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sensemakr.sensitivity_stats.partial_f2" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>Description:</strong>
This function computes the partial (Cohen's) f2 for a linear regression model. The partial (Cohen's) f2 is a
common measure of effect size (a transformation of the partial R2) that can also be used directly
for sensitivity analysis using a bias factor table.
For details see Cinelli and Hazlett (2020).</p>
<p><strong>Reference:</strong>
Cinelli, C. and Hazlett, C. (2020), &quot;Making Sense of Sensitivity: Extending Omitted Variable Bias.&quot;
Journal of the Royal Statistical Society, Series B (Statistical Methodology).</p>
<p>This function takes as input a statsmodels OLSResults object or you may pass directly t-value &amp; degrees of freedom.</p>
<p><strong>Required parameters:</strong> either model or (t_statistic and dof).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> -- a statsmodels OLSResults object containing the restricted regression</p></li>
<li><p><strong>covariates</strong> -- a string or list of strings with the covariates used to compute the t_statistic and dof
from the model. If not specified, defaults to all variables.</p></li>
<li><p><strong>t_statistic</strong> -- a float with the t_statistic for the restricted model regression</p></li>
<li><p><strong>dof</strong> -- an int with the degrees of freedom of the restricted regression</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a float with the computed partial f^2</p>
</dd>
</dl>
<p><strong>Examples:</strong></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load example dataset:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">darfur</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">load_darfur</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Fit a statsmodels OLSResults object (&quot;fitted_model&quot;):</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s1">&#39;peacefactor ~ directlyharmed + age + farmer_dar </span><span class="se">\</span>
<span class="go">            +herder_dar + pastvoted + hhsize_darfur + female + village&#39;, data=darfur)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fitted_model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load this module:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">sensitivity_stats</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Partial f2 of directly harmed with peacefactor:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sensitivity_stats</span><span class="o">.</span><span class="n">partial_f2</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">fitted_model</span><span class="p">,</span> <span class="n">covariates</span> <span class="o">=</span> <span class="s2">&quot;directlyharmed&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Partial f2 of female with peacefactor:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sensitivity_stats</span><span class="o">.</span><span class="n">partial_f2</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">fitted_model</span><span class="p">,</span> <span class="n">covariates</span> <span class="o">=</span> <span class="s2">&quot;female&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># You can also provide the statistics directly:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sensitivity_stats</span><span class="o">.</span><span class="n">partial_f2</span><span class="p">(</span><span class="n">t_statistic</span> <span class="o">=</span> <span class="mf">4.18445</span><span class="p">,</span> <span class="n">dof</span> <span class="o">=</span> <span class="mi">783</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sensemakr.sensitivity_stats.group_partial_r2">
<span class="sig-prename descclassname"><span class="pre">sensemakr.sensitivity_stats.</span></span><span class="sig-name descname"><span class="pre">group_partial_r2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_statistic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sensemakr/sensitivity_stats.html#group_partial_r2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sensemakr.sensitivity_stats.group_partial_r2" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>Description:</strong>
Partial R2 of groups of covariates in a linear regression model</p>
<p>This function computes the partial R2 of a group of covariates in a linear regression model. Multivariate version
of the partial_r2 function; see that for more details.</p>
<p><strong>Required parameters:</strong> either model or (f_statistic, p, and dof).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> -- a statsmodels OLSResults object containing the restricted regression</p></li>
<li><p><strong>covariates</strong> -- a string or list of strings with the covariates used to compute the t_statistic and dof
from the model. If not specified, defaults to all variables.</p></li>
<li><p><strong>f_statistic</strong> -- a float with the f_statistic for the restricted model regression</p></li>
<li><p><strong>p</strong> -- an int with the number of parameters in the model</p></li>
<li><p><strong>dof</strong> -- an int with the degrees of freedom of the restricted regression</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a float with the computed group partial R^2</p>
</dd>
</dl>
<p><strong>Examples:</strong></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load example dataset:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">darfur</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">load_darfur</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Fit a statsmodels OLSResults object (&quot;fitted_model&quot;):</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s1">&#39;peacefactor ~ directlyharmed + age + farmer_dar </span><span class="se">\</span>
<span class="go">            + herder_dar + pastvoted + hhsize_darfur + female + village&#39;, data=darfur)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fitted_model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">sensitivity_stats</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sensitivity_stats</span><span class="o">.</span><span class="n">group_partial_r2</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">fitted_model</span><span class="p">,</span> <span class="n">covariates</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;female&quot;</span><span class="p">,</span> <span class="s2">&quot;pastvoted&quot;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>
<section id="sensemakr-ovb-bounds">
<h1>sensemakr.ovb_bounds<a class="headerlink" href="#sensemakr-ovb-bounds" title="Permalink to this headline">¶</a></h1>
<section id="id7">
<h2>Description<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h2>
<p>Bounds on the strength of unobserved confounders using observed covariates, as in Cinelli and Hazlett (2020).
The main generic function is ovb_bounds, which can compute both the bounds on the strength of confounding
as well as the adjusted estimates, standard errors, t-values and confidence intervals.</p>
<p>Other functions that compute only the bounds on the strength of confounding are also provided. These functions
may be useful when computing benchmarks for using only summary statistics from papers you see in print.</p>
<p>Currently it implements only the bounds based on partial R2. Other bounds will be implemented soon.</p>
</section>
<section id="id8">
<h2>Reference<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h2>
<p>Cinelli, C. and Hazlett, C. (2020), &quot;Making Sense of Sensitivity: Extending Omitted Variable Bias.&quot; Journal of the Royal Statistical Society, Series B (Statistical Methodology).</p>
</section>
<section id="id9">
<h2>Example<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h2>
<p>See specific functions below.</p>
<dl class="py function">
<dt class="sig sig-object py" id="sensemakr.ovb_bounds.ovb_bounds">
<span class="sig-prename descclassname"><span class="pre">sensemakr.ovb_bounds.</span></span><span class="sig-name descname"><span class="pre">ovb_bounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">treatment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">benchmark_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ky</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'partial</span> <span class="pre">r2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adjusted_estimates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sensemakr/ovb_bounds.html#ovb_bounds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sensemakr.ovb_bounds.ovb_bounds" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>Description:</strong></p>
<p>Bounds on the strength of unobserved confounders using observed covariates, as in Cinelli and Hazlett (2020).
The main generic function is ovb_bounds, which can compute both the bounds on the strength of confounding
as well as the adjusted estimates, standard errors, t-values and confidence intervals.</p>
<p>Other functions that compute only the bounds on the strength of confounding are also provided. These functions
may be useful when computing benchmarks for using only summary statistics from papers you see in print.</p>
<p>Currently it implements only the bounds based on partial R2. Other bounds will be implemented soon.</p>
<dl class="field-list simple">
<dt class="field-odd">Required parameters</dt>
<dd class="field-odd"><p>model and treatment</p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>model</strong> -- a fitted statsmodels OLSResults object for the restricted regression model you have provided</p></li>
<li><p><strong>treatment</strong> -- a string with the name of the &quot;treatment&quot; variable, e.g. the independent variable of interest</p></li>
<li><p><strong>benchmark_covariates</strong> -- a string or list of strings with names of the variables to use for benchmark bounding</p></li>
<li><p><strong>kd</strong> -- a float or list of floats with each being a multiple of the strength of association between a
benchmark variable and the treatment variable to test with benchmark bounding</p></li>
<li><p><strong>ky</strong> -- same as kd except measured in terms of strength of association with the outcome variable</p></li>
<li><p><strong>alpha</strong> -- a float with the significance level for the robustness value RV_qa to render the
estimate not significant</p></li>
<li><p><strong>h0</strong> -- a float with the null hypothesis effect size; defaults to 0</p></li>
<li><p><strong>reduce</strong> -- whether to reduce (True, default) or increase (False) the estimate due to putative confounding</p></li>
<li><p><strong>bound</strong> -- type of bound to perform; as of now, only partial R^2 bounding is allowed</p></li>
<li><p><strong>adjusted_estimates</strong> -- whether to compute bias-adjusted estimates, standard errors, and t-statistics</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p>A Pandas DataFrame containing the following variables:</p>
<ul class="simple">
<li><p>treatment : the name of the provided treatment variable</p></li>
<li><p>bound_label : a string created by label_maker to serve as a label for the bound for printing &amp; plotting purposes</p></li>
<li><p>r2dz_x : a float or list of floats with the partial R^2 of a putative unobserved confounder &quot;z&quot;
with the treatment variable &quot;d&quot;, with observed covariates &quot;x&quot; partialed out, as implied by z being kd-times
as strong as the benchmark_covariates</p></li>
<li><p>r2yz_dx : a float or list of floats with the partial R^2 of a putative unobserved confounder &quot;z&quot;
with the outcome variable &quot;y&quot;, with observed covariates &quot;x&quot; and the treatment variable &quot;d&quot; partialed out,
as implied by z being ky-times as strong as the benchmark_covariates</p></li>
<li><p>adjusted_estimate : the bias-adjusted estimate adjusted for a confounder with the given r2dz_x and r2yz_dx above</p></li>
<li><p>adjusted_se : the bias-adjusted standard error adjusted for a confounder with the given r2dz_x and r2yz_dx above</p></li>
<li><p>adjusted_t : the bias-adjusted t-statistic adjusted for a confounder with the given r2dz_x and r2yz_dx above</p></li>
</ul>
</p>
</dd>
</dl>
<p><strong>Reference:</strong></p>
<p>Cinelli, C. and Hazlett, C. (2020), &quot;Making Sense of Sensitivity: Extending Omitted Variable Bias.&quot; Journal of the Royal Statistical Society, Series B (Statistical Methodology).</p>
<p><strong>Example:</strong></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load example dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">darfur</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">load_darfur</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Fit a statsmodels OLSResults object (&quot;fitted_model&quot;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s1">&#39;peacefactor ~ directlyharmed + age + farmer_dar + herder_dar + &#39;</span>\
<span class="go">                &#39;pastvoted + hhsize_darfur + female + village&#39;, data=darfur)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fitted_model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Bounds on the strength of confounders 1, 2, or 3 times as strong as female</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># and 1, 2, or 3 times as strong as pastvoted</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">ovb_bounds</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ovb_bounds</span><span class="o">.</span><span class="n">ovb_bounds</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">fitted_model</span><span class="p">,</span> <span class="n">treatment</span> <span class="o">=</span> <span class="s2">&quot;directlyharmed&quot;</span><span class="p">,</span>\
<span class="go">           benchmark_covariates = [&quot;female&quot;, &quot;pastvoted&quot;], kd = [1, 2, 3])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sensemakr.ovb_bounds.ovb_partial_r2_bound">
<span class="sig-prename descclassname"><span class="pre">sensemakr.ovb_bounds.</span></span><span class="sig-name descname"><span class="pre">ovb_partial_r2_bound</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">treatment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r2dxj_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r2yxj_dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">benchmark_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ky</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sensemakr/ovb_bounds.html#ovb_partial_r2_bound"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sensemakr.ovb_bounds.ovb_partial_r2_bound" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>Description:</strong>
The function <cite>ovb_partial_r2_bound()</cite> returns only a Pandas DataFrame with the bounds on the strength of the
unobserved confounder. Adjusted estimates, standard errors and t-values (among other quantities) need to be computed
manually by the user using those bounds with the functions adjusted_estimate, adjusted_se and adjusted_t.</p>
<dl class="field-list simple">
<dt class="field-odd">Required parameters</dt>
<dd class="field-odd"><p>(model and treatment) or (r2dxj_x and r2yxj_dx)</p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>model</strong> -- a fitted statsmodels OLSResults object for the restricted regression model you have provided</p></li>
<li><p><strong>treatment</strong> -- a string with the name of the &quot;treatment&quot; variable, e.g. the independent variable of interest</p></li>
<li><p><strong>r2dxj_x</strong> -- float with the partial R2 of covariate Xj with the treatment D (after partialling out the effect of the remaining covariates X, excluding Xj).</p></li>
<li><p><strong>r2yxj_dx</strong> -- float with the partial R2 of covariate Xj with the outcome Y (after partialling out the effect of the remaining covariates X, excluding Xj).</p></li>
<li><p><strong>benchmark_covariates</strong> -- a string or list of strings with names of the variables to use for benchmark bounding</p></li>
<li><p><strong>kd</strong> -- a float or list of floats with each being a multiple of the strength of association between a
benchmark variable and the treatment variable to test with benchmark bounding</p></li>
<li><p><strong>ky</strong> -- same as kd except measured in terms of strength of association with the outcome variable</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p>A Pandas DataFrame containing the following variables:</p>
<ul class="simple">
<li><p>bound_label : a string created by label_maker to serve as a label for the bound for printing &amp; plotting purposes</p></li>
<li><p>r2dz_x : a float or list of floats with the partial R^2 of a putative unobserved confounder &quot;z&quot;
with the treatment variable &quot;d&quot;, with observed covariates &quot;x&quot; partialed out, as implied by z being kd-times
as strong as the benchmark_covariates</p></li>
<li><p>r2yz_dx : a float or list of floats with the partial R^2 of a putative unobserved confounder &quot;z&quot;
with the outcome variable &quot;y&quot;, with observed covariates &quot;x&quot; and the treatment variable &quot;d&quot; partialed out,
as implied by z being ky-times as strong as the benchmark_covariates</p></li>
</ul>
</p>
</dd>
</dl>
<p><strong>Reference:</strong>
Cinelli, C. and Hazlett, C. (2020), &quot;Making Sense of Sensitivity: Extending Omitted Variable Bias.&quot; Journal of the Royal Statistical Society, Series B (Statistical Methodology).</p>
<p><strong>Examples:</strong>
Let's construct bounds from summary statistics only. Suppose you didn't have access to the data, but only to the treatment and outcome regression tables.
You can still compute the bounds.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># First import the necessary libraries.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">sensitivity_stats</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">bias_functions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">ovb_bounds</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">ovb_plots</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Use the t statistic of female in the outcome regression to compute the partial R2 of female with the outcome.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r2yxj_dx</span> <span class="o">=</span> <span class="n">sensitivity_stats</span><span class="o">.</span><span class="n">partial_r2</span><span class="p">(</span><span class="n">t_statistic</span> <span class="o">=</span> <span class="o">-</span><span class="mf">9.789</span><span class="p">,</span> <span class="n">dof</span> <span class="o">=</span> <span class="mi">783</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Use the t-value of female in the *treatment* regression to compute the partial R2 of female with the treatment.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r2dxj_x</span> <span class="o">=</span> <span class="n">sensitivity_stats</span><span class="o">.</span><span class="n">partial_r2</span><span class="p">(</span><span class="n">t_statistic</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.680</span><span class="p">,</span> <span class="n">dof</span> <span class="o">=</span> <span class="mi">783</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute manually bounds on the strength of confounders 1, 2, or 3 times as strong as female.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span> <span class="o">=</span> <span class="n">ovb_bounds</span><span class="o">.</span><span class="n">ovb_partial_r2_bound</span><span class="p">(</span><span class="n">r2dxj_x</span> <span class="o">=</span> <span class="n">r2dxj_x</span><span class="p">,</span> <span class="n">r2yxj_dx</span> <span class="o">=</span> <span class="n">r2yxj_dx</span><span class="p">,</span>\
<span class="go">                kd = [1, 2, 3], ky = [1, 2, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute manually adjusted estimates.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bound_values</span> <span class="o">=</span> <span class="n">bias_functions</span><span class="o">.</span><span class="n">adjusted_estimate</span><span class="p">(</span><span class="n">estimate</span> <span class="o">=</span> <span class="mf">0.0973</span><span class="p">,</span> <span class="n">se</span> <span class="o">=</span> <span class="mf">0.0232</span><span class="p">,</span>\
<span class="go">                    dof = 783, r2dz_x = bounds[&#39;r2dz_x&#39;], r2yz_dx = bounds[&#39;r2yz_dx&#39;])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot contours and bounds.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ovb_plots</span><span class="o">.</span><span class="n">ovb_contour_plot</span><span class="p">(</span><span class="n">estimate</span> <span class="o">=</span> <span class="mf">0.0973</span><span class="p">,</span> <span class="n">se</span> <span class="o">=</span> <span class="mf">0.0232</span><span class="p">,</span> <span class="n">dof</span> <span class="o">=</span> <span class="mi">783</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ovb_plots</span><span class="o">.</span><span class="n">add_bound_to_contour</span><span class="p">(</span><span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span> <span class="n">bound_value</span> <span class="o">=</span> <span class="n">bound_values</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>
<section id="module-sensemakr.data">
<span id="sensemakr-data"></span><h1>sensemakr.data<a class="headerlink" href="#module-sensemakr.data" title="Permalink to this headline">¶</a></h1>
<section id="id10">
<h2>Description<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h2>
<p>The module provides the example data of darfur based on a survey among Darfurian refugees in eastern Chad.</p>
</section>
<section id="id11">
<h2>Reference<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h2>
<p>Hazlett C (2019). “Angry or Weary? How Violence Impacts Attitudes toward Peace among
Darfurian Refugees.” Journal of Conflict Resolution.</p>
</section>
<section id="id12">
<h2>Example<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h2>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sensemakr</span> <span class="kn">import</span> <span class="n">data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">darfur</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">load_darfur</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py function">
<dt class="sig sig-object py" id="sensemakr.data.load_darfur">
<span class="sig-prename descclassname"><span class="pre">sensemakr.data.</span></span><span class="sig-name descname"><span class="pre">load_darfur</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sensemakr/data.html#load_darfur"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sensemakr.data.load_darfur" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the darfur example data of the packages.</p>
</dd></dl>

</section>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="modules.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">sensemakr</p>
        </div>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2021, Nathan LaPierre, Kenny Zhang, Brain Hill, Carlos Cinelli.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.3.1.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>